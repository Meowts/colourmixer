<!DOCTYPE html>

<html ng-app="colours">
	<head>
		<script type="text/javascript" src="angular.js"></script>
		<script type="text/javascript" src="app.js"></script>

		<style>
			table, table td {
				border: 1px solid black;
			}
			td {
				height: 100px;
				width: 100px;
				vertical-align: bottom;
			}
			input {
				width: 96px;
			}
			.opacity-input {
				width: 36%;
				display: inline;
			}
			#colon {
				padding-left: 3px;
				padding-right: 4px;
				color: white;
			}
		</style>
	</head>

	<body>
		<div id="container" ng-controller="ColourCtrl as ctrl">			
			<table>
				<tr ng-repeat='row in table track by $index'>
					
					<!-- Show base colour and controls -->
					<td 
						ng-if="$parent.$index == 0" 
						ng-repeat="column in row track by $index"
						style="background-color : {{ colours[column] }}"
					>
						<!-- Colour controls -->
						<input 
							ng-model="colours[column]" 
							ng-keyup="calcColours(colours, settings, $index, colours[column])" 
							ng-show="$parent.$index != 0"
						/>

						<!-- Opacity controls -->
						<input 
							ng-model="settings.opacityA" 
							class="opacity-input" 
							ng-keyup="calcColours(colours, settings, null, null)" 
							ng-show="$parent.$index == 0"
						/>
						<span id="colon" ng-show="$parent.$index == 0">:</span>
						<input 
							ng-model="settings.opacityB" 
							class="opacity-input" 
							ng-keyup="calcColours(colours, settings, null, null)" 
							ng-show="$parent.$index == 0"
						/>
						
					</td>

					<!-- Show calculated colours -->
					<td 
						ng-if="$parent.$index != 0" ng-repeat="column in row track by $index"
						ng-style="$index != 0 ? { 'background-color' : calculatedColours[$parent.$parent.$index][column] } : { 'background-color' : colours[column] }"
					>
						{{ calculatedColours[$parent.$parent.$index][column] }}
						{{ $index != 0 ? getRGB(calculatedColours[$parent.$parent.$index][column]) : '' }}
					</td>
				</tr>
			</table>
		</div>
	</body>
</html>